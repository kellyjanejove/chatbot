'use strict';

// tests for get-assignee-personnel-numbers
// Generated by serverless-mocha-plugin

const dataInitializer = require('./initializers/assigneeNamesInitializer.js');
const mod = require('../assignee/get-assignee-personnel-numbers.js');
const mochaPlugin = require('serverless-mocha-plugin');

const lambdaWrapper = mochaPlugin.lambdaWrapper;
const expect = mochaPlugin.chai.expect;
const wrapped = lambdaWrapper.wrap(mod, { handler: 'handler' });

describe('get-assignee-personnel-numbers', () => {
  var assigneeList = [];
  before((done) => {
    dataInitializer.seed().then(function (assignees) {
      assigneeList = assignees;
      done();
    });
  })

  it('it should return a list', () => {
    return wrapped.run({}).then((response) => {
      let results = JSON.parse(response.body);
      expect(results.length).to.be.above(0);
    });
  });

  it('it should filter based on the value parameter in the querystring', () => {
    return wrapped.run({
      queryStringParameters: {
        value: '000018481'
      }
    }).then((response) => {
      console.log(response);
      let results = JSON.parse(response.body);
      //console.log(results);
      expect(results[0].AssigneePersonnelNumber).to.equal('000018481');
    });
  });
});
