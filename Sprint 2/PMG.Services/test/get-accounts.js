'use strict';

// tests for get-accounts
// Generated by serverless-mocha-plugin
const dataInitializer = require('./initializers/accountInitializer.js');
const mod = require('../account/get-accounts.js');
const mochaPlugin = require('serverless-mocha-plugin');
const lambdaWrapper = mochaPlugin.lambdaWrapper;
const expect = mochaPlugin.chai.expect;
const wrapped = lambdaWrapper.wrap(mod, {
  handler: 'handler'
});

describe('get-accounts', () => {
  var accountList = [];
  before((done) => {
    //  lambdaWrapper.init(liveFunction); // Rmochaun the deployed lambda
    dataInitializer.seed().then(function (accounts) {
      accountList = accounts;
      done();
    });
  });

  it('it should return a list', () => {
    return wrapped.run({
    }).then((response) => {
      let results = JSON.parse(response.body);
      expect(results.length).to.be.above(0);

    });
  });
  it('it should format CodeTxt correctly', () => {
    return wrapped.run({
    }).then((response) => {
      let results = JSON.parse(response.body);
      expect(results[0].Number).to.be.equal(accountList[0].CodeTxt + ' - ' + accountList[0].DecodeTxt);

      //done();
    });


  });
});